"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,_toPropertyKey(a.key),a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);t=n.call(e,t||"default");if("object"!==_typeof(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}var navDropdown=function(){function a(e,t){t=t.getBoundingClientRect(),e.style.top="".concat(t.bottom,"px"),e.style.right="".concat(window.innerWidth-t.right,"px")}function n(t){if(-1!==i)return i;(i=document.createElement("div")).classList.add("burger-dropdown"),a(i,t);var n,e=t.parentElement;return e&&(n=!0,Array.from(e.children).forEach(function(e){e.className!==t.className&&(n||i.appendChild(document.createElement("hr")),n=!1,i.appendChild(e.cloneNode(!0)))})),document.body.appendChild(i),i}var i=-1,o=-1;return window.addEventListener("DOMContentLoaded",function(){var e=Array.from(document.querySelectorAll("a.burger"));0<e.length&&n(e[0]),document.addEventListener("click",function(e){var t,n;-1!==i&&(t=i.getBoundingClientRect(),n=e.clientX,e=e.clientY,(n<t.left||e<t.top||n>t.right||e>t.bottom)&&(Date.now()-o<100||i.classList.remove("active")))}),window.addEventListener("resize",function(){-1!==i&&i.classList.remove("active")})}),function(e){var t=n(e);t.classList.contains("active")||a(t,e),t.classList.add("active"),o=Date.now()}}(),navigate=function(){function e(e){t?e():n.push(e)}function l(){if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}return null}var t=!1,n=[],a=function(){function n(e,t){_classCallCheck(this,n),this.container=e,this.slider=t,this.deployment=1,this.progress=0,this.update()}return _createClass(n,[{key:"_easeInOut",value:function(e){if(0===e)return 0;if(1===e)return 1;var t=.5*Math.cos(Math.PI*e)+.5;return t*Math.pow(e,4)+(1-t)*(1-Math.pow(e-1,4))}},{key:"update",value:function(){this.container.style.top="".concat(100*(1-this._easeInOut(this.deployment)),"vh"),this.slider.style.width="".concat(100*this._easeInOut(this.progress),"%")}},{key:"getDeployment",value:function(){return this.deployment}},{key:"setDeployment",value:function(e){this.deployment=Math.min(Math.max(e,0),1),e<=0&&(this.progress=0),this.update()}},{key:"getProgress",value:function(){return this.progress}},{key:"setProgress",value:function(e){this.progress=Math.min(Math.max(e,0),1),this.update()}}]),n}(),h=null;e(function(){var e=document.querySelector("[data-role='loading']"),t=e.querySelector("[data-role='loading-progress']");h=new a(e,t)});function d(e){for(;e.match(/^\.+\//)||e.startsWith("/");)e=e.substring(e.indexOf("/")+1);return e}function i(){var e=(location||window.location).hash;e.length<2?s("home"):(e=e.substring(1),s(e))}var u=function(){function t(e){var a=this;_classCallCheck(this,t),this.list=Array.from(e),this.progressList=[],this.anyError=!1;for(var i=0;i<this.list.length;i++)!function(){a.progressList.push(0);var e=a.list[i],t=i,n=a;e.onprogress=function(e){e.lengthComputable&&(n.progressList[t]=Math.max(Math.min(e.loaded/e.total,1),0))},e.onreadystatechange=function(){4==e.readyState&&(n.progressList[t]=1,(e.status<200||400<=e.status)&&(n.anyError=!0))},e.send()}()}return _createClass(t,[{key:"getProgress",value:function(){if(this.progressList.length<1)return 1;for(var e=0,t=0;t<this.progressList.length;t++)e+=this.progressList[t];return e/this.progressList.length}}]),t}(),p=null,o=function(){function t(e){_classCallCheck(this,t),this.name=e,this.el=this._getElement(),this.loading=!!this.el,this.requestList=null,this.body=null,this.myBodyIsReady=!1,this.bodyApplied=!1,this.linkedAssets=[],this.objectUrls=[],this.pageData=null,this.inRetractionPeriod=!1,this.unloadPreviousPageCallbacks=[],this.unloadedPreviousPage=!1,this.headAppendReady=!1,this.headAppendReadyCallbacks=[],this.isPreLoadDeploying=!1,this.loading&&this._startLoading()}return _createClass(t,[{key:"_whenHeadAppendReady",value:function(e){this.headAppendReady?e():this.headAppendReadyCallbacks.push(e)}},{key:"_setHeadAppendReady",value:function(){if(!this.headAppendReady){this.headAppendReady=!0;for(var e=0;e<this.headAppendReadyCallbacks.length;e++)this.headAppendReadyCallbacks[e]();this.headAppendReadyCallbacks=[]}}},{key:"whenUnloadPreviousPage",value:function(e){this.unloadPreviousPageCallbacks.push(e)}},{key:"_onUnloadPreviousPage",value:function(){for(var e=0;e<this.unloadPreviousPageCallbacks.length;e++){var t=this.unloadPreviousPageCallbacks[e];"function"==typeof t&&t()}this.unloadPreviousPageCallbacks=[]}},{key:"_getElement",value:function(){if("void"===this.name)return null;if(this.el)return this.el;var e=document.querySelector("main"),t=e.querySelector('[data-page="'.concat(this.name,'"]'));return t||((t=document.createElement("section")).setAttribute("data-page",this.name),e.appendChild(t),t)}},{key:"isLoading",value:function(){return this.loading}},{key:"abortLoading",value:function(){this.unloadedPreviousPage||this._onUnloadPreviousPage(),this.loading=!1,"404"!==this.name&&s("404")}},{key:"_startLoading",value:function(){var e,t,n=this;this.loading&&(this.loading=!0,(e=l()).open("GET","./pages/"+this.name+".json"),e.responseType="json",t=Promise.race([new Promise(function(t){e.addEventListener("load",function(){try{t("object"===_typeof(e.response)?e.response:JSON.parse(e.response))}catch(e){console.warn(e),t(null)}}),e.addEventListener("error",function(e){console.warn(e),t(null)});try{e.send()}catch(e){console.warn(e),t(null)}}),new Promise(function(e){setTimeout(function(){e(null)},18e3)})]),this.isPreLoadDeploying=!0,this._enterPreLoadWithDataDeployTask(),t.then(function(e){n.isPreLoadDeploying=!1,e?n._startLoadingWithData(e):n.abortLoading()}).finally(function(){n.isPreLoadDeploying=!1}))}},{key:"_enterPreLoadWithDataDeployTask",value:function(){var e,t;window.requestAnimationFrame?(e=this,window.requestAnimationFrame(function(){e._preLoadWithDataDeployTask()})):(t=this,setTimeout(function(){t._preLoadWithDataDeployTask()},10))}},{key:"_preLoadWithDataDeployTask",value:function(){var e,t,n;this.isPreLoadDeploying&&(e=h.getDeployment(),n=((t=Date.now())-(this.lastPreLoadTick||t))/1e3,this.lastPreLoadTick=t,h.setDeployment(e+2*n),this._enterPreLoadWithDataDeployTask())}},{key:"_handleBodyLoadFromData",value:function(e){var t=this,n=e.type.toLowerCase();if("basic"===n){var a=l();return a.open("GET","./assets/"+d(e.path)),a.responseType="text",a.addEventListener("load",function(){t.body=a.responseText||a.response.toString(),t.myBodyIsReady=!0}),a}"project"===n&&(n=e.elements,e=document.createElement("div"),JSMD.parse(e,n),this.body=e.innerHTML,this.myBodyIsReady=!0)}},{key:"_responseTextToDataURI",value:function(e,t,n){if(Blob&&URL&&URL.createObjectURL&&!window.document.documentMode){var a=new Blob([e.responseText||e.response.toString()],{type:t}),a=URL.createObjectURL(a);return n&&this.objectUrls.push(a),a}return"data:"+t+";base64,"+window.btoa(e.responseText||e.response.toString())}},{key:"_startLoadingWithData",value:function(e){var a=this;this.pageData=e;var i=[];document.title=e.title;var t=this._handleBodyLoadFromData(e.body);if(t&&i.push(t),e.scripts)for(var o=Array.from(e.scripts),s=0;s<o.length;s++)(function(){var e="./assets/"+d(o[s]),t=window.btoa(e);if(document.querySelector('script[data-dynamic-hash="'+t+'"]'))return;var n=l();n.open("GET",e),n.responseType="text",n.addEventListener("load",function(){var e;a.loading&&((e=document.createElement("script")).setAttribute("data-dynamic-hash",t),e.src=a._responseTextToDataURI(n,"application/javascript",!0),e.setAttribute("type","application/javascript"),a._whenHeadAppendReady(function(){document.head.appendChild(e)}))}),i.push(n)})();if(e.stylesheets)for(var n=Array.from(e.stylesheets),r=0;r<n.length;r++)!function(){var t=l();t.open("GET","./assets/"+d(n[r])),t.responseType="text",t.addEventListener("load",function(){var e;a.loading&&((e=document.createElement("link")).rel="stylesheet",e.href=a._responseTextToDataURI(t,"text/css"),a._whenHeadAppendReady(function(){document.head.appendChild(e)}),a.linkedAssets.push(e))}),i.push(t)}();this.requestList=new u(i),window.requestAnimationFrame(function(){a._loadTick()})}},{key:"_loadTick",value:function(){if(this.loading){var e=this,t=function(){window.requestAnimationFrame(function(){e._loadTick()})},n=Date.now(),a=(n-(this.lastLoadTick||n))/1e3;this.lastLoadTick=n;var i=h.getDeployment();if(this.inRetractionPeriod)return i-=2*a,h.setDeployment(i),i<=0?(this.loading=!1,void("function"==typeof p&&(p(this),p=null))):void t();if(1e-12<Math.abs(i-1)&&i<1.01)return h.setDeployment(i+2*a),void t();this._setHeadAppendReady(),this.unloadedPreviousPage||(this._onUnloadPreviousPage(),this.unloadedPreviousPage=!0);var o=this.requestList.getProgress(),n=h.getProgress();if(this.myBodyIsReady&&!this.bodyApplied){this.el.innerHTML=this.body;for(var s=document.querySelector("main"),r=s.childNodes,l=[],d=0;d<r.length;d++){var u=r.item(d);u instanceof Element&&u.hasAttribute("data-page")&&u.getAttribute("data-page")!==this.name&&l.push(u)}for(var c=0;c<l.length;c++)s.removeChild(l[c]);this.bodyApplied=!0}i=y<o?.3:-.3,a=n+Math.max(o-n,i)*a*2;h.setProgress(a),Math.abs(a-1)<=.05&&Math.abs(o-1)<=1e-12&&(o=new CustomEvent("moduleLoad",{detail:{page:this.name}}),window.dispatchEvent(o),this.inRetractionPeriod=!0),t()}}},{key:"unload",value:function(){for(var e=0;e<this.linkedAssets.length;e++)document.head.removeChild(this.linkedAssets[e]);this.linkedAssets=[];for(var t=0;t<this.objectUrls.length;t++)URL.revokeObjectURL(this.objectUrls[t]);this.objectUrls=[]}}]),t}(),y=new o("void"),s=function n(a){e(function(){var t,e=a.toLowerCase();e!==y.name&&(y.isLoading()?p=function(){n(e)}:(t=y,(y=new o(e)).whenUnloadPreviousPage(function(){var e=new CustomEvent("moduleUnload",{detail:{page:t.name}});window.dispatchEvent(e),t.unload()})))})};return window.addEventListener("DOMContentLoaded",function(){Array.from(n).forEach(function(e){e()}),t=!0,n=null,i()}),window.addEventListener("hashchange",i),s}();